environment:
    CI_DESIRED_NETWORK: "netavark"
adjust+:
    - when: distro == centos-stream
      environment+:
        ROOTLESS_USER: "ec2-user"
    - when: distro == rhel
      environment+:
        ROOTLESS_USER: "cloud-user"

/local-root:
    tag: [ local, root, system ]
    summary: local rootful test
    test: >
        bash ./setup.sh &&
        make -C $TMT_TREE localsystem
    duration: 40m
    
/local-rootless:
    tag: [ local, rootless, system ]
    summary: rootless test
    test: >
        bash ./setup.sh &&
        loginctl enable-linger $ROOTLESS_USER &&
        chown -R $ROOTLESS_USER $TMT_TREE &&
        su - "$ROOTLESS_USER" -c "CI_DESIRED_NETWORK=netavark make -C $TMT_TREE localsystem"
    duration: 40m

/remote-root:
    tag: [ remote, root, system ]
    summary: remote rootful test
    test: >
        bash ./setup.sh &&
        make -C $TMT_TREE remotesystem
    duration: 40m

/remote-rootless:
    tag: [ remote, rootless, system ]
    summary: remote rootless test
    test: >
        bash ./setup.sh &&
        loginctl enable-linger $ROOTLESS_USER &&
        chown -R $ROOTLESS_USER $TMT_TREE &&
        su - "$ROOTLESS_USER" -c "CI_DESIRED_NETWORK=netavark make -C $TMT_TREE remotesystem"
    duration: 40m
